<!DOCTYPE html>
<html>
  <title></title>
  <style>
    body {background-color: #777;}
    canvas {background-color: white;}
    div{margin-bottom:10px;}
    input {width: 50px;}
    button {width: 100px;}
    #fps {position:absolute; top: 7px; left: 10px;}
  </style>
  <body>
    <canvas width="1200" height="800" id="canvas"></canvas>
    <div>
      <button id="animate">animate</button>
      <!-- <img src="./test.jpg"> -->
    </div>
    <span id="fps"></span>
    <script src="./index.js"></script>
    <script>
      var canvas = document.getElementById('canvas')
        , context = canvas.getContext('2d')
        , centerX = canvas.width / 2
        , centerY = canvas.height / 2
        , shapeStyle = {
            fillStyle: '#337'
          }
        , img = new Image()

      img.src = "./test.jpg";

      img.onload = function() {
        update();
        updateFps();
      }




      var shape1 = new Shape('rect', {
        x1: centerX - 200,
        y1: centerY - 250,
        x2: centerX + 200,
        y2: centerY + 250,
        centerX: centerX,
        centerY: centerY,
        scale: 1,
        rotate: 0
      });

      shape1.set({
        fillStyle: "#999"
      });

      var shape2 = new Shape('circle', {
        x1: centerX - 200,
        y1: centerY - 150,
        x2: centerX - 100,
        y2: centerY - 250,
        centerX: centerX,
        centerY: centerY,
        rotate: 0
      });


      var pointX = 0
        , pointY = 0;

      canvas.addEventListener('mousemove', function(event){
        var contains1 = shape1.contains(event.offsetX, event.offsetY);
        var contains2 = shape2.contains(event.offsetX, event.offsetY);
        if (contains2 !== false) {
          shapeStyle.fillStyle = '#733';
        } else {
          shapeStyle.fillStyle = '#337';
        }
        console.log(contains1);
      });


      var transition = {
        rotate: 360,
        // scale: .5
      },
      duration = 4000;


      shape1.set(transition, duration);
      shape2.set(transition, duration);


      var fps = 60;
      var $fps = document.getElementById('fps');

      function updateFps() {
        $fps.textContent = fps;
        fps = 0;
        setTimeout(updateFps, 1000);
      }

      function update() {
        shape1.update();
        shape2.update(shapeStyle);
        requestAnimationFrame(draw);
      }

      function draw() {
        context.clearRect(0,0,canvas.width,canvas.height);
        drawCenter();

        shape1.draw(context, img, true);
        shape2.draw(context);

        fps++;
        setTimeout(update, 0);
      }


      function drawCenter() {
        context.save();

        context.strokeStyle = '#555';
        context.beginPath();
        context.moveTo(centerX, 0);
        context.lineTo(centerX, canvas.height);
        context.stroke();

        context.beginPath();
        context.moveTo(0, centerY);
        context.lineTo(canvas.width, centerY);
        context.stroke();

        context.restore();
      }


    </script>
  </body>
</html>
